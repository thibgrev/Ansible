- name: Deployment of the new VM named "{{ VMname }}"
  hosts: localhost
  gather_facts: no
  become: no

  tasks:
    
    - name: create the VM
      vmware.vmware_rest.vcenter_vm:
        vcenter_hostname: "dcavcsa1a.dca.scc"
        vcenter_username: "tgrevellec"
        vcenter_password: 'Tb"%c[[V@7__=.Neu\\y'
        vcenter_validate_certs: False
        name: "{{ VMname }}"
        placement:
          folder: "tgrevellec"
          datacenter: "DCA"
        template_library_item:: "tg-template-rhel9"
        state: present
        power_on: true
        wait_for_ip_address: yes
        hardware:
          memory_mb: 2048 #"{{ vmware_deploy_hardware_memory }}"
          num_cpus: 4 #"{{ vmware_deploy_hardware_cpus }}"
          hotadd_memory: "true"
          hotadd_cpu: "true"